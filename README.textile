h1. Relating Data about Congress

Congrelate, a project of the "Sunlight Labs":http://sunlightlabs.com, is a web app and data aggregation framework written in "Sinatra":http://sinatrarb.com. At its core, "Congrelate":http://congrelate.com is a dynamic, sortable spreadsheet of data about Members of Congress. 

By pulling in other sets of data about campaign contributions and voting records, a user can quickly answer questions like: "Which women voted against the Lily Ledbetter Fair Pay Act?" or "Which industries are the largest contributions to members of the Senate Finance Committee?". 

Congrelate accomplishes this by pulling together data from various sources. Currently, the standard data sources used are:

* "Sunlight Labs API":http://wiki.sunlightlabs.com/index.php/Sunlight_Labs_API for basic information on members of Congress and the committees they sit on.
* US Census data for demographic information on congressional districts.
* "OpenSecrets.org":http://opensecrets.org for industry contribution data.
* "GovTrack.us":http://govtrack.us for congressional vote history.


h2. Set Up

Congrelate uses Sinatra for the basic web framework, ActiveRecord for storing data from the data sources, and jQuery to power the dynamic data table. See @congrelate.rb@ and @public/javascripts/congrelate.js@ for the implementation details.

h3. Core App

* Required gems: sinatra, htmlentities, activerecord, activesupport.
* Set up a database, copy @config/database.yml.example@ to @config/database.yml@ and modify as needed.
* Run @rake db:migrate@.

h3. Legislator Data

* Code located at @sources/legislator/@.
* Required gems: open-uri, json, technicalpickles-daywalker (from GitHub).
* Register for a "Sunlight Labs API key":http://services.sunlightlabs.com/api/register/.
* Copy @sources/api_keys.yml.example@ to @sources/api_keys.yml@ and add your Sunlight API key for "legislator".
* Run @rake sources:update SOURCE=legislator@

h3. District Census Data

* Code located at @sources/district/@, data at @data/census/@.
* Required gems: fastercsv
* Run @rake sources:update SOURCE=district@

h3. Industry Contribution Data

* Code located at @sources/contribution/@, data at @data/opensecrets@.
* Required gems: httparty, fastercsv
* *Important*: OpenSecrets.org releases their data under their OpenData initiative (as a zipped up CSV file) and via an API. The dataset is preferred, but to get this, you must sign up for an account at "OpenSecrets.org":http://opensecrets.org and download the 2008 Campaign Finance data set "here":http://www.opensecrets.org/MyOS/bulk.php. Unzip that into @data/opensecrets/@, creating the @opensecrets/@ directory if necessary. So the .csv files should be in @data/opensecrets/CampaignFin08@.
* Otherwise, you'll need to register an API key at OpenSecrets and pop it into @sources/api_keys.yml@ for "contribution".
* Run @rake sources:update SOURCE=contribution@

h3. Roll Call Congressional Data

* Code located at @sources/roll_call/@, data at @data/govtrack@.
* Required gems: hpricot
* Run @rake sources:update SOURCE=roll_call@

h3. Finishing Set Up

* A simple @rake sources:update@ will update all data sources according to their TTL values in @sources/sources.yml@.
* Running @ruby congrelate.rb@ will fire up the app.

h2. Developing Your Own Data Sources

You are strongly encouraged to contribute your own data sources to the project. In five easy steps:

# Fork the project on GitHub if you haven't already
# Create a new directory in @sources/@
# Write an ActiveRecord model that defines class methods for sorting the data, generating a column of the data, and updating the data.
# Write the ERB/HTML necessary for displaying the form pop-up that allows the user to select the data.
# Send us a pull request when you're ready.

See the @data/example@ directory for details.