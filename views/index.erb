<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang='en-US' xml:lang='en-US'>
  <head>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
    <title>Big Sheet</title>

    <link charset='utf-8' href='/css/main.css' media='screen' rel='stylesheet' type='text/css' />
    <link charset='utf-8' href='/facebox/facebox.css' media='screen' rel='stylesheet' type='text/css' />
    <script src='/javascript/jquery.js' type='text/javascript'></script>

    <script src='/javascript/bigsheet.js' type='text/javascript'></script>
    <script src='/facebox/facebox.js' type='text/javascript'></script>
    <script src='/javascript/jquery.metadata.min.js' type='text/javascript'></script>
    <script src='/javascript/tablesorter.js' type='text/javascript'></script>
    <script src='/javascript/ui-table-filter.js' type='text/javascript'></script>
    <script type='text/javascript'>
      $(document).ready(init);
    </script>
  <!--[if IE 6]><link rel="stylesheet" href="/css/buggy.css" type="text/css" media="screen" /><![endif]-->
  </head>
  
  <body class='home'>
    <div id='headerWrapper'>
      <div id='mainBg'>
        <div class='container'>
          <div class='container2'>
            <div class='container3'>
              <div id='mainHeader'>
                <h1>
                  <a href='/'>Comparing Legislator Votes and their Constituencies</a>
                </h1>
              </div>
              <div id='headerNav'>
                <div id='filter'>
                  <h2>Filter</h2>
                  <ul>
                    <li>
                      <input class='text' id='filter_field' maxlength='329' type='text' value='e.g. "kennedy", "senate ny"' />
                    </li>
                    <li id='spinner' style='display: none; padding-top: 5px; padding-left: 10px;'>
                      <img src='/images/spinner.gif'/>
                    </li>
                  </ul>
                  
                  <div class="download">
                    <h2>Download</h2>
                    <a href="#" id='csv'>CSV</a> |
                    <a href="#" id='json'>JSON</a> |
                    <a href="#" id='xml'>XML</a>
                  </div>
                  
                  <div class="permalink">
                    <a href="#">Permalink</a>
                  </div>
                </div>
              </div>
              <div id='mainContent'>
                <table class='display' id='main_table'>
                  <thead>
                    <tr class='titles'>
                      <% sort_by_ref(@data.keys, source_keys).each do |source| %>
                        <% sort_fields(@data[source].keys, source).each do |column| %>
                          <th title="<%= @data[source][column][:title] %>" class="<%= source %>_<%= column %><%= @data[source][column][:type] ? " {sorter: '#{@data[source][column][:type]}'}" : "" %>">
                            <span>
                              <%= @data[source][column][:header] ? @data[source][column][:header] : column.to_s.titleize %>
                            </span>
                          </th>
                        <% end %>
                      <% end %>
                    </tr>
                  </thead>
                  <tbody>
                    <% @legislators.each do |legislator| %>
                      <tr id="<%= legislator.bioguide_id %>">
                        <% sort_by_ref(@data.keys, source_keys).each do |source| %>
                          <% sort_fields(@data[source].keys, source).each do |column| %>
                            <td class="<%= source %>_<%= column %>">
                              <%= @data[source][column][legislator.bioguide_id] %>
                            </td>
                          <% end %>
                        <% end %>
                      </tr>
                    <% end %>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id='footerWrapper'>
      <div id='footerMain'>
        <div id="footerTab">
          <h2>Add Data</h2>
        </div>
        <div id='dataContent'>
          <div id='addBtns'>
            <ul>
              <% sources.each do |source| %>
                <li>
                  <a class="source_form_link" href='#' id="<%= source.keyword %>_form_link">
                    <%= source.name %>
                  </a>
                </li>
              <% end %>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>